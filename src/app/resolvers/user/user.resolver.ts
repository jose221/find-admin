import { UserService } from './../../services/auth/user.service';
import { FirebaseUserModel } from './../../../models/userFirebase.model';

import { Injectable } from '@angular/core';
import { Resolve, ActivatedRouteSnapshot, Router } from '@angular/router';

@Injectable()
export class UserResolver implements Resolve<FirebaseUserModel> {

  constructor(public userService: UserService, private router: Router) { }

  resolve(route: ActivatedRouteSnapshot): Promise<FirebaseUserModel> {

    const user = new FirebaseUserModel();

    return new Promise((resolve, reject) => {
      this.userService.getCurrentUser()
        .then(res => {
          if (res.providerData[0].providerId === 'password') {
            console.log(res);
            // tslint:disable-next-line:max-line-length
            user.image = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxASEBAQEBASFRUXFg8QEBYVFhUXFhUQFREWGBUWFxYYHiggGBooGxYWIjEhJSktLi8uFx8zODMtNygtLisBCgoKDg0OGg8QGjUdHSUtLS0tLi0rLS0tLS0tLS0tLS0tNy0tLS0tLS0tLS0tLS0tLSstLS0rLS0tLS0tLS0tLf/AABEIAKgBKwMBIgACEQEDEQH/xAAcAAEAAgMBAQEAAAAAAAAAAAAAAgMBBAUHBgj/xABMEAABAwEEBQcHCQMMAgMAAAABAAIRAwQSITEFIkFRYRNxgZGh0dIGFBYyUlSTFyNTYpKxssLwM0KjBxUkQ0RVgqLB0+HxNOIlY3L/xAAZAQEBAQEBAQAAAAAAAAAAAAAAAQIDBAX/xAAoEQEAAgECBQQCAwEAAAAAAAAAARECE/ASUWKBoQMUIWEEcVKR0TH/2gAMAwEAAhEDEQA/ALNHeT9CvZab21RTqXbTUqudBGo4hjI5QXWkNOsGkyRwC27J5IUbzi+0OcGvrU7nJgOfdp6rwW1CACSHNBIvARgTC+4+TzRfu7vjVvGsfJ5ov3c/FreNe2fyI5z/AFH+vPpTyj+3wrfIunIHnrTLnNwYwzD3tN353EtuS4YQHCCVyfKbRVOzupclUD2vYxxumWtcKVO8L0ySXEuiBAc2J2eo/J5ov3c/FreNPk90X7u741bxqx+TETczM9o/1J9Ga+I8vEKdWQTGXajajoJLeZe4fJ9oz6B3xq3jT5PdGfQO+NW8a37vDlO+7Ohk8h8mqDa1qs1Oq2Wuq02OEkSwuAOIMjrXqrfIyw5HRzvWInlqkXZMO9echkr3fyf6MGIoOzb/AF1bePrqz0C0d9DU+PX8a4+r68ZzcTMb/bph6c4x8xE7/SFn8htGubLrGWncatUnserfQLRnuv8AEreNR9AtHfQ1Pj1/GnoFo76Gp8ev41z1Oqd92+HpjfZL0C0Z7r/EreNPQLRnuv8AEreNR9AtHfQ1Pj1/GnoFo76Gp8ev401Oqd9zh6Y32S9AtGe6/wASt409AtGe7fxK3jUfQLR30NT49fxp6BaO+hqfHr+NNTqnfc4emN9kvQLRnuv8Wt409AtGe6/xK3jUfQLR30NT49fxp6BaO+hqfHr+NNTqnfc4emN9mfQLRnuv8St41n0C0Z7r/EreNR9AtHfQ1Pj1/GnoFo76Gp8ev401Oqd9zh6Y32ZPkFoz3Xd/WVt//wC18n5b+TVms9jNWnZuTqcrTYCH1HAsLSTF55GYjYcJgSvq/QLR30NT49fxrDvIDRpzovPPWr+NXH1YiYmcpnf7ScLiqjfZ4mi9r+T3Rnu7vjVvGnye6M93d8at416fd4cp33cdDJ4oi9r+T3Rnu7vjVvGnye6M93d8at4093hynfc0Mn5+8prU+nRDqbrpvtEiMrrsMeZT/k6rttNpNO22hzKUaz4EtwdGzCSAMV73U/k50U4Q6zXhudVqkdRcsUv5NtEtm5ZLs53alUTzw5ccvXic+K5rf26R6UxjVQ+S9HNCf3o/7VPwJ6OaE/vR/wBqn4F9j8nujPd3fGreNPk90Z7u741bxq6+P8p8JpTyjy+O9HNCf3o/7VPwLleUeidHUqTXWS2urPLw0sN06kGXarRGMda9G+T3Rnu7vjVvGnye6M93d8at41Y/Ixif+z4J9KeUeXkVCyUXMa42lrXG9eaWON3WgYjA4YrLrHRloFpaZME3Hw0a2J6hh9bZC9c+T3Rnu7vjVvGnye6M93d8at41r3WH34Z0cvry8obo+zkH+mMwgmWOEyQIAOf6yzWlUosDw0VAWyyXgGACBeMHHDHqXsnye6M93d8at40+T3Rnu7vjVvGkflYffg0cvp5M2xWf3tuz+rfw/wCf9YWixjSYLoEOMwTJAMCM8cunGF7P8nujPd3fGreNPk90Z7u741bxqx+Vh9+DQy+niiL2lv8AJ9ozH+juz+mrbh9dS+T3Rnu7vjVvGr7vDlO+6aGTa01Yar3iKlymb1+CGvdgLt1xOrBGO8FU1tFWovcWVrrSRq3WuLRcAiS6M5dlt2gBdHTNmZULA69IvDVAOq6ASZ5lrWxlifUc59W6+aZeLxbMhhbq7ZAaJz44CPmxnlcxMfD2TjFQop6KtQLb1YESS4XGC8JBaAQcMARtmeC3fM3+z2hUihYngHlMZLQb7g4uvTvmf9I4Lds1tsrGtYytTgABovjcT3lb4pZpR5k/2e0J5k/2e0LronFJTlUrK8OaS3CW7t4V+lGVzyXIkgB55UNLA4suOiC8EetdJ2wOg7dTLpb+ILLp2R0qTNlPn6zdKPbdmzsm6HFodeGOsQSSNkDbBnApZbRpOS11Kjq8iC4yAZnlCMcYAGwYnaF3pd9XrPcmvub1nuS1cW9pPWaW0PVADmzJqGkZMF2q2/G8xv2WWL+cOUbynIcnfqF8Xi64Wat0zAh3DERkV1tfc3rPcmvub1nuSx8/ZrRpV4k07OzIazXZ3m3jF/1Yv3dpgTG2wv0rceblmvxUuDWukyy5Lr2QHKE4DEADeu5r7m9Z7k19zes9yWOPbW6QuMFE0r013OvnbfJotJH7t0wYxw6VmobeDRc0UjPmwrgmA0co7l3NAJ1rsRrRK6+tub1nuSXfV6z3JY5FoqaR1uTZQOtaLt4kC4J5HbJJF29gMZ2QTWXaTziznBkAAtN7kql+ZccL/JkRxGOa7evub1nuTX3N6z3KDFlLzTYagAfdbygbkHwLwHCZVqr19zes9ya+5vWe5BYir19zes9ya+5vWe5BYir19zes9ya+5vWe5BYir19zes9ya+5vWe5BYir19zes9ya+5vWe5BYir19zes9ya25vWe5BYsKGvub1nuTW3N6z3ILEVevub1nuTX3N6z3ILEVYLvq9Z7lJs7Y6EGGZu5/yhTUGZu5/yhTQcvTVWm3ky9l7GRrXThidokYZHDJYrWll4zZXu9S6RTvS0tGMxAi8Rnv4rGmfOJHIhxECYu53sZDt8jqKurOtd8hjaRZq3XEm9gBekRmTlCfA132ll7Gx1CRjPJtOAyM8+zNX2Z1N7rhszmiHOl9Nobk2cRtN89TtyxftmOpR2RrOx1ROzDGefDLbdZnWi9842kG44tLiZwjMc/Yg3EREEKmXS38QSpEEHIyEqZdLfxBQtUxhnjHPCDmN0FZgLoNSMYHKVIE7InLFbVhsNKkSWOfJaGG897hAJIwOAOP3LnClbog1bPOONx8ncYmAetWcnbLrgalC9DbpDX4OvaxxmRdywzQdnlW705Vu9chzbVDYdQmNfB+L5OW4Rd7VFjLZIJfQzEgB/qzjidsIOzyrd6cq3etZAgoZoygMr0ZxefE7MP1kpmw0dXF+ExrOnEtJx/wjt3rUZabThes4xIBioMBGJy7FN9esIu0Q7D2w2DdBjHiSOhBf/N9L2qmz99/Du/UBXWejTYXFpdjnJcR6zjgDli4rQdaLRmKAzyvtMtjYdhmN+AKx5zaJ/wDGEYf1jdw4cSOhB2OVbvTlW71yBabRB/o+M4DlG5Xdp33sFbZ6tQmKlMME7H3sLzYyiMz1IOlyrd6cq3evJ3+WvlBJ/wDgHZn9+oe0HHnWPTbyg/uB326neg9Z5Vu9OVbvXk3pt5Qf3A77dTvX3PkdpC02mzcrbrKbLVvvbyZeTLBEOxMiZIjhxQfQcq3enKt3qu4zf/mPeqrRh6gkwcL2eI3oNnlW705Vu9cutVrtu3aTX4G/DrsHYBOfP+hX5zacf6O3IkfOjMbJjag7HKt3pyrd65fL1rzhyIu3Zab4kuuzEc+HQom01/d/4jYQdblW705Ub1yXV68YURN6PXEXY9brwhRbarQf7NGWdRucCdnP1IOxyrd6cq3euVZ61cuAfRDW46weDETBjjgOtbiCgaMoYQXiIiHOwAEADrPWt+iGgBrcgABnkOJzWurbPt6FbmRYzN3P+UKagzN3P+UKag43lNybqbab6zKZvNeLz7khs7eeO1WHR7nOJZaqgIuyGlpa08mGghpBiYBgyMTvlVactNJj2h4fLrrNSJiHuwkYQGvJOCptbbA6oQ8w8cmXGXjAtYReIwi6xuavzSfDt2alcaG3i6JxdmZM4q1cez6QsdFpDX3WkknB5xDBOY3AforadpajeewOJc3MAE43mtwOWb2j/oqK3kXMOnrLh86DM4gOjrjiFfZNKUariym+SBeyIwmNo4hBs1Mulv4go2jIKVTLpb+IKNfIIKEREBERAQIiDWpivIvGnG3OSO9R/pGH7Ib/AFuH/KoGmrLJBqXSC0EODwdZ91pyyJyPELNXTNlaSHVmgglpGtMgkERGOIKDY+fuj9le2+tH7v8A7diiRaNhpHL2htx7FRS0zZnXrtSS1r6jgA6bjb0nLLVPZvCO01ZQ2/you3mU51vWcTGYywdjlqncg23crLouRhdmc8Jkfa7FWRaMMaXHByps2mLLULWsqglxuswcLztbAEj6jueOImP892WL3KQMMbr4xGGMINsCrLZ5OP38DPrbP8PbKieXjKlP+KIw4c61m6cshE8sIxGT59YiYjIkYHarXaTs4vg1ACw3XjWlpvluUZSDjwQXRWg/s5nA62UYyN8wsEVoH7KZM+tlOELVOnLJE8qIgmbtSIAk7Fh2nbIDHKj94Ew6ARmCYzQdJgMCYnbGUqS0DpWheqNDiXMN14AdM3mtw36zgOvcqjp6yQCKwIykB5GbRnGUub1oOoi59m0vZqjxTZVBcQSBrDKN+3Fb90IMosBoWUBERAREQFbZ9vQqlbZ9vQgsZm7n/KFNQZm7n/KFJBr2uyU6kCpSa+MReDSPVI28HOHSrgfqns71q6UrtY0F1U08XXTBdjcdmBnGeO5c99uaSZtb2jKTTgSQTgYwjjwxVqZT4dqfqns70n6p7O9cippJoytR1RrfN4knW3CNVzY/7UqNrAewG0udfxaOTiRNzdhiOAwSpLh1Z+qezvSfqns71z7LfqNDmWkmCQdQZ/vCFuU6Tw6TUkQMC0ZwBMjmJjioqb3cDm3dvHFYtGQUqmXS38QUa+QQUIiICIiAiLICDCixgEwAJJJgRJOZ51803yyYQCLPWIM3YgzBjIcZHODuUj5XiAfNbRBmNXdE7MsR1rppZ8mePF27RbmscQ5r9hkNJmZyAx2ZxGIUBpNmEtqCTA1HZyBkOcLjM8sGnKy2g7fVwiAZmMoIx4hKvli1sl1mrgDMkYDGMTsx+8JpZ8jjxdmhpFj3Bt14mC28wgEAB045QTtxkFW17YxnrCscCdSjVqCAKhzY0iYpHDOS0ZuaDClb2lrHS1t9t8BzoN2ASThAAvATxG9Z8+pgftaUcKvGDlxXNpI2xkgRXxIb+wrZl7W+zgJcMcok5AlbVnaHsa8FwDmteA5hY4AiRea4BzTwIBCppVb2TgRrYteXCWmCOefuKs6XdZ70FvIcexOQ49iq6XdZTHe7rKCx9KATOQJyVaEcT1lEBERAREQEREBERAVtn29CqVtn29CCxmbuf8oU1Bmbuf8AKFJBp6TqlrWnlhSE6xLb0iDhjlzrRdUd6xtbIEBvzWLXwSDMzi1zefphdW00nOi64NInEgHZxyVAs9b6UfZGO6SrZTSpWhwBm1g5Nb80RBkGTJ1iQI6VN9oJ1hawA68WfN4RPbEtHQtttGtIJqt4i7n+u/fhtXRhgMMuCWOX50YLhaRAaQZpiL8vAcDsxLRGPqjelAPc4DzskiHQKYbLYB6cCOtdWEhLSkamXS38QWKwkBZqZdLfxBZeDBgwYMHODzKK17h3FLh3Fago26CBWozGqXMLjejNxbdBE7gFmrStpaLtWgDrz824jNtz97L1p5xjhiG1cO4pcO4rVdRtuyrRGM+o4iJ5/wBTntVlnp2oObfqUi3G9DXAkQYjHDH9YYhdcO5Aw7ltIg+Oo+RVwQy2WxoEkBr2ACTOADd6yfIuWlptttumQ4X2wQc5F3GV9IylXEfOMO+Wx93T2LNFleddzIg5AzM4Erpq5c2eDF80PIzAN89tsDIX2wMIyu8AsVPIq8C11ttpBwIL2EETOILeCs8w0173R6m/7SeYaa97o9Tf9pTVyXTxdJ2hGFjWOaHta0MF9jHYANnMbS1p5wNyw7QVI4GnTOBH7KnkYkZbbrfsjcud5hpr3uj1N/2ls2eyaVDHh9ppFxB5MwMDG3UH3GOOSw1Tp2ex3IAyAIADQAJMnAK+4dxXznmGmve6PU3/AGk8w0173R6m/wC0oU+juHcUuHcqdC0rS2lFqqNfUvOMtAAu4QMGjHPYugqjVuHclw7itpEGrcO4pcO5bSINW4dxS4dxW0iDVuHclw7itpYQa1w7kuHcVtIg1bh3Kyi0iehagpWrD52mcs254GSYG/7lv0wYF4gmBeIwBMYwNiswMMzdz/lCmoMzdz/lCmoCwsogwsoiAiIghUy6W/iCy8wCYmATG08AsVMulv4gpOO2YQcoaXO2y2icJuswxjK9BOe7YVh2mDiG2S0kiQJpwCRe/enLVz+sFtt0lQN0ivTN71dZuOE/cR1hbLHAgEOkHEEQQRvBQVWOuKjb1x7MXNh7brtVxExuMSOBV8DckcUjigQNyQEjikcUGoLZhPI1dki4c7s4Tnu51g23/wCir9gHYTsPDtCubaaZEio0jDaNuSk2uwwA9p3QR+to60FDbZJ/Y1BgSNXOBPRuHOsi15fM1cTd9UYYtEnHLWn/AAlWec0/pG5E5tyH/aujig1BbMDNGphE6s5hxw3+r/mCg63R/UVcifV3c33LejikcUGoy1yCeRqfZ2SROPMgtgkfNVcYg3N5iTu6VtxxSOKBA3JA3JHFI4oEDckBI4pHFAgbkgbkjikcUCBuSBuSOKRxQIG5IG5I4pHFAgbkgbkjikcUHNGkjhNnrbJhhMEgndjsHOeldCk6WgwRIBg5iRkY2qlttpGIqtxiMRjn3FXscCAQZBxBEQRwhWUYZm7n/KFNQZm7n/KFNRRERAREQEREEKmXS38QUnDhKjUy6W/iCy8YESRIIkZjmQaf802f3elnPqtzwx7B1LapUw1oa1oAAAaBgABkAua3RlQR/S6oAEQLkbMZIJnDftKso6Pe0EG1VTIAE3JEFuMxidU5+0UHRk7kk7lzP5tfBHndaMv3ZiDkY5urnUG6LqTPnlbZPqRAJwiOKDrTwSeCXhvS8N6CkWWnj823HPAYo2ysERTaIywCpNkOMVngbBIMHHeP1CybKc+WfMObs2umY4ZdAQTNjp/Rt6grwIwAWmLG7baKn+Ub9w49iNsjrsG0POIM6swGgRllIn/hBuzwSeC0HWJxEecVNserPqwNnSp0LK5rg413uEyWm7BwcN2GYy9kINyeCTwS8N6XhvQJO5J4JeG9Lw3oE8Engl4b0vDegTwSeCXhvS8N6BJ3JJ3JI3pI3oE8Engl4b0kb0CTuSeCXhvS8N6DW8wpfRM2bBsyWwwQIAgDAcy540e4RFoqYRGIyAOc55yt+k2ABJMACTmcMyrKDM3c/wCUKagzN3P+UKaiiwsogwsoiAiIghUy6W/iCy6YMZwY51ipl0t/EFlxgSdmJQcplqtsY2anOMfOARj0yt+xVajmk1aYY6SAA4OkYYyOnqVbNI0TlUG0RiDIzBBxBCky3UTlUacznuBP3AlWpS20i1W22kZio3DPHjCMt1EmBUb18CfuB6ilSttpFrstdMxDxjIGO0RI58Qo+e0pi+P1s51BSLRacJoAnaQ8AbOfeeroWWVrTBmkwGMNaZdeGzZhPUrRbaX0g61bRqteJa6Rl07kGmLRacuQGTZN8ASYnDr6lfZKlUyKjA2A2CDMmMSNwmcOHHDZjnSOdBlFiOdI50GUWI50jnQZRYjnSOdBlFiOdI50GUWI50jnQZRYjnSOdBlYSOdI50GUWI50jnQc5totWE0WnKYcBjBmMcpgLfpk3ReABgSBiAYxE7VKOdAFZkRZm7n/AChSUWZu5/yhTUBERAREQEREEKmXS38QUlioMOkHqIWL59k9negh5tTy5Nm71Rlh3DqQWWnM8myYiboyiI5oJ61O+fZPZ3pfPsns70sR83Z7DdgyGQMjtWG2amMmMG3BoziPuwU759k9nel8+yezvQYFFuGq3DEYDA/oDqWeSb7I35DNL59k9nel8+yezvQYNFud1s8w/W1SawDIAcwWL59k9nel8+yezvQTRQvn2T2d6Xz7J7O9BNFC+fZPZ3pfPsns70E0UL59k9nel8+yezvQTWFG+fZPZ3pfPsns70E1hRvn2T2d6Xz7J7O9BNFC+fZPZ3pfPsns70E0UL59k9nel8+yezvQTWFG+fZPZ3pePsns70E1hRvn2T2d6Xz7J7O9BNYUb59k9nel8+yezvQGZu5/yhTUGTjhGP8AoFNAWFlEGEWUQEREGFqGy1JMVnAZxAMaxOZ4GOZEQYbZKmE13GI/dbjEYHh+ufLrI4gjlXYuc6cciDAzyE9nSiILKVBwmahMiBnhrE7TxA6FrCw1ojzl0Q0eqJygmSZkoisSJeY1Ijzh8ywzEYNnDAjPaoiw1sJtLsNzQMRET1dqIlylNyzUy1oDnlxxlxwmSTkpVmXmuaHFsgiRmJGY4rCKK1W2OqP7Q4+rm1ux04xvGClSstQOBNdxF1rSLrYJDSCeBJM9G6IwitpSNSw1CTFoeAXOcRnnOAOwQYjpWDYauEWl2H1Rv6ssP0ZIlyUtNlddYOVdLRBOOJuxOec44yMcjhEadlqgOm0OJwAJa3DKTAzmO1ESykX2OsWkC0OzzutmLpEYRtIM8OlYp2OsIm0E4z6rYLQ6Y5yBHSVlEspKvY6hcXNrubhEQCMiMjhnjgB04RE2OqRBtDszMNaMMcBu51lEspFthqzPnL/styxwx58/+IsFlfyZYazicIdABwu7o3H7RREspWbFWn/yXxgRqsznGcIIjYrXWVxawGs+Wm8XCBezwI3YjqCIllKxY6vvDsgBqtwIOfHYFOy2Wo061ZzxEAEAbRjxy27yiJZSrzGrEecvyjIHZiZJJ7dvNEvM6vvD/st34Z/rAcZyiXJSYsr+Tcw1nyRF8BocBDQYwzwOP1lU6x1j/aTtPqN3EbM80RLKdBYWUUV//9k=';
            user.name = res.displayName;
            user.provider = res.providerData[0].providerId;
            user.email = res.providerData[0].email;
            return resolve(user);
          } else {
            user.image = res.photoURL;
            user.name = res.displayName;
            user.provider = res.providerData[0].providerId;
            user.email = res.providerData[0].email;
            return resolve(user);
          }
        }, err => {
          this.router.navigate(['/login']);
          return reject(err);
        });
    });
  }
}
